# ======================================
# Luchida - 環境変数設定テンプレート
# ======================================
# このファイルを .env にコピーして使用してください
# cp .env.example .env

# ======================================
# アプリケーション設定
# ======================================
NODE_ENV=development
PORT=3000
LOG_LEVEL=info

# ======================================
# データベース設定
# ======================================
DATABASE_URL="mysql://user:password@localhost:3306/luchida"

# ======================================
# OANDA API設定
# ======================================
OANDA_API_URL=https://api-fxpractice.oanda.com
OANDA_API_KEY=your_practice_api_key_here
OANDA_ACCOUNT_ID=your_account_id_here

# 本番環境では以下を使用
# OANDA_API_URL=https://api-fxtrade.oanda.com

# ======================================
# セキュリティ設定
# ======================================
JWT_SECRET=your_jwt_secret_here_change_in_production
JWT_EXPIRES_IN=7d
CORS_ORIGIN=http://localhost:5173

# ======================================
# 1. リスク管理ルール
# ======================================

## 1.1 ポジションサイズ制限
MAX_POSITION_SIZE=10000          # 1ポジションの最大サイズ（通貨単位）
MIN_POSITION_SIZE=1000           # 1ポジションの最小サイズ（通貨単位）

## 1.2 損切り・利確設定
STOP_LOSS_PIPS=20                # 損切りライン（pips）
TAKE_PROFIT_PIPS=40              # 利確ライン（pips）
ALLOW_MANUAL_SL_TP=false         # 手動での損切り・利確設定を許可するか

## 1.3 日次損失制限
MAX_DAILY_LOSS=5000              # 1日の最大損失額（円）
MAX_DAILY_LOSS_PERCENTAGE=2.0    # 口座残高に対する最大損失率（%）
DAILY_LOSS_RESET_HOUR=0          # 損失カウントリセット時刻（0-23, JST）

## 1.4 最大保有ポジション数
MAX_OPEN_POSITIONS=5             # 最大同時保有ポジション数
MAX_POSITIONS_PER_PAIR=2         # 同一通貨ペアの最大ポジション数

## 1.5 レバレッジ制限
MAX_LEVERAGE=10                  # 最大レバレッジ倍率（1-25）

# ======================================
# 2. タイミングルール
# ======================================

## 2.1 取引可能時間帯
TRADING_START_HOUR=9             # 取引開始時刻（時: 0-23）
TRADING_START_MINUTE=0           # 取引開始時刻（分: 0-59）
TRADING_END_HOUR=17              # 取引終了時刻（時: 0-23）
TRADING_END_MINUTE=0             # 取引終了時刻（分: 0-59）
TRADING_TIMEZONE=Asia/Tokyo      # タイムゾーン

## 2.2 取引可能曜日
# カンマ区切り（0=日曜, 1=月曜, ..., 6=土曜）
TRADING_ALLOWED_DAYS=1,2,3,4,5   # 月〜金のみ取引

## 2.3 経済指標前後の取引制限
BLOCK_BEFORE_NEWS_MINUTES=30     # 指標発表前の制限時間（分）
BLOCK_AFTER_NEWS_MINUTES=10      # 指標発表後の制限時間（分）
NEWS_CALENDAR_ENABLED=true       # 経済指標カレンダー機能の有効化
HIGH_IMPACT_ONLY=true            # 高影響度指標のみブロック

# ======================================
# 3. エントリー条件ルール
# ======================================

## 3.1 RSI（相対力指数）
RSI_ENABLED=true                 # RSIルールの有効化
RSI_PERIOD=14                    # RSI計算期間
RSI_OVERSOLD=30                  # 売られ過ぎ閾値（0-100）
RSI_OVERBOUGHT=70                # 買われ過ぎ閾値（0-100）
RSI_TIMEFRAME=M5                 # 使用する時間軸（M1, M5, M15, M30, H1, H4, D）

## 3.2 移動平均線（MA）
MA_ENABLED=true                  # MAルールの有効化
MA_SHORT_PERIOD=25               # 短期MA期間
MA_LONG_PERIOD=75                # 長期MA期間
MA_CROSSOVER_REQUIRED=true       # クロスオーバー必須
MA_TIMEFRAME=M15                 # 使用する時間軸

## 3.3 ボリンジャーバンド
BB_ENABLED=false                 # BBルールの有効化
BB_PERIOD=20                     # BB計算期間
BB_STD_DEV=2.0                   # 標準偏差倍率
BB_TIMEFRAME=M5                  # 使用する時間軸

## 3.4 トレンド強度
TREND_STRENGTH_ENABLED=true      # トレンド強度チェックの有効化
MIN_TREND_STRENGTH=0.7           # 最小トレンド強度（0.0-1.0）
TREND_CALCULATION_METHOD=ADX     # トレンド計算手法（ADX, LinearRegression）

# ======================================
# 4. 市場条件ルール
# ======================================

## 4.1 通貨ペア制限
# カンマ区切りで指定（OANDA形式: BASE_QUOTE）
ALLOWED_CURRENCY_PAIRS=USD_JPY,EUR_JPY,GBP_JPY

## 4.2 スプレッド制限
MAX_SPREAD_PIPS=3.0              # 最大許容スプレッド（pips）
CHECK_SPREAD_ENABLED=true        # スプレッドチェック有効化

## 4.3 流動性チェック
MIN_VOLUME_REQUIRED=1000         # 最小要求ボリューム
LIQUIDITY_CHECK_ENABLED=false    # 流動性チェック有効化

# ======================================
# 開発・デバッグ用設定
# ======================================

## ルールエンジン
RULE_ENGINE_DEBUG=false          # ルールチェックの詳細ログ出力
DRY_RUN_MODE=false               # ドライランモード（実際の注文は実行しない）

## モニタリング
ENABLE_METRICS=true              # メトリクス収集の有効化
METRICS_PORT=9090                # Prometheus metrics port

# ======================================
# 注意事項
# ======================================
# 1. 本番環境では必ず .env を .gitignore に追加してください
# 2. OANDA_API_KEY は絶対に公開しないでください
# 3. JWT_SECRET は本番環境で必ず変更してください
# 4. 初めは Practice API で十分にテストしてから Live API に移行してください
# 5. ルール変更後は必ずバックテストで検証してください
